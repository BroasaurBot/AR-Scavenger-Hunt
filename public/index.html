<!DOCTYPE html>
<html>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" href="./index.css">
  <head>
  </head>

  <script src="https://aframe.io/releases/1.0.4/aframe.min.js"></script>
  <script src="https://raw.githack.com/AR-js-org/AR.js/master/aframe/build/aframe-ar.js"></script>

  <script src="./js/info.js"></script>
  <script src="./js/firebase.js" type="module"></script>
  <script src="./js/markerEvents.js" type="module"></script>
  <!--
  <script src="./js/progress.js" type="module"></script>
  <script src="./js/topbar.js" type="module"></script>
  -->


  <body style="margin: 0px; overflow: hidden;">

    <a-scene embedded arjs='sourceType: webcam; debugUIEnabled: false; detectionMode: mono_and_matrix; matrixCodeType: 3x3_PARITY65;' vr-mode-ui="enabled: false">
        <div id="marker_root"></div>
    </a-scene>

    <!--    
    <div class="popup" id="logo">
        GDSC    
        <img src="./icons/gdsc.png" alt="GDSC">
        USYD
    </div>

  <div class="popup" id="topbar">
    <div id="signIn" class="hide">
      <p style="text-align: center;">Please <span style="font-weight:bold">sign in</span> to track progress</p>
      <button class="button">
        <img src="./icons/login.png" alt="Sign In">
      </button>
    </div>


    <div id="tooltip" class="hide">
      <h2 id="characterName"></h2>
      <div id="description"></div>
    </div>

    <div id="progress" class="hide">
      <div id="collected">
        <h4>Markers Collected: </h4>
        <div id="progressBar">
          <div id="progressBarFill"></div>
        </div>
        <p id="count"></p>
      </div>

      <div id="pointsInfo">
        <div id="pointsprize">
          <div id="points"></div>
          <div id="prize"></div>
        </div>
        <div id="motivation"></div>
      </div>
    </div>

    <div id="rules">
        <a href="https://dash.gdscusyd.org/" target="_blank">Learn more</a>
        <a href="https://dash.gdscusyd.org/rules" target="_blank">Rules</a>
        <a href="https://dash.gdscusyd.org/clues" target="_blank">Clues</a>
    </div>
  </div> 

  <div class="popup hide" id="Animation">
    <div id="character" class="rainbow"></div>
    <div id="points" class="rainbow"></div>
  </div>

  <div class="popup hide" id="bottombar">
    <div id="marker-inspector">
      <button id="interact" class="">
        <img src="./icons/library_add.png" alt="add">
      </button>
      <p>
        Go search for a marker
      </p>
      <button id="information" class="">
        <img src="./icons/info.png" id='info' alt="info">
        <img src="./icons/close.png" id='close' class="hide" alt="info">
      </button>
    </div>
  </div>

    -->


  </body>
   <script>
    let a_scene = document.querySelector('#marker_root');
    let camera = "<a-entity camera></a-entity>"

    content = ""
    for (let i = 0; i < markerInfo.length; i++) {
        const marker = markerInfo[i];
        const template = `<a-marker markerhandler type="barcode" value="${i}" smooth="true">` +
                `<a-entity ` +
                    `scale="${marker.scale} ${marker.scale} ${marker.scale}" ` +
                    `rotation="${marker.rotation}" ` +
                    `position="${marker.position}" ` +
                    `gltf-model="/models/${marker.model_name}/scene.gltf"` +
                `></a-entity>` +
            `</a-marker>`

        content = content + template;
    }

    content = content + camera;
    a_scene.outerHTML = content;
  </script>

  <script>
    // Workaround for an AR.js bug (https://github.com/jeromeetienne/AR.js/issues/410)
    const sceneEl = document.querySelector('a-scene');
    sceneEl.addEventListener('loaded', () => {
    sceneEl.camera = new THREE.PerspectiveCamera();
    });
  </script>

</html>
